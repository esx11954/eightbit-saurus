---
sidebar_position: 4
---

# Active Directory セキュリティ課題

Active Directory には以下の「役職」を持つユーザーが存在します。
- 部長
- 課長
- なし (一般社員または役職なしの社員)

最終的には以下の様に役職別で各共有フォルダに対するアクセス制御が設定されている状態にして下さい。

|共有フォルダ|アクセス要件|
|---|---|
|\\\FileServer\Public|全社員（部長、課長、なしのすべての役職）が読み取り可能。|
|\\\FileServer\DepartmentData|アクセス元ユーザーの部署と、フォルダの部署属性が一致するユーザーが読み書き可能。|
|\\\FileServer\ManagementReports|ユーザーの役職が「部長」である場合に読み取り可能。|
|\\\FileServer\ProjectX|ユーザーの役職が「課長」であるか、または特定のプロジェクトメンバーグループに属するユーザーが読み書き可能。|

### ステップ1. ファイルサーバを構築し、上記の共有フォルダを作成して下さい。
ファイルサーバはドメインコントローラのサーバ内に構築しても構いません。  
よくわからない場合は別の仮想マシンを作成し、WindowsServerをインストールし、ファイルサーバを構築して下さい。

### ステップ2. 上記のアクセス要件を満たすように設定してみましょう。
ユーザの属性でアクセス制御することになるためダイナミックアクセス制御という設定をすることになります。  
[こちら](https://learn.microsoft.com/ja-jp/windows-server/identity/solution-guides/dynamic-access-control-overview) を確認して概要を確認し、設定に進みましょう。

### ステップ3. グループポリシーの更新
ドメインコントローラーから、ファイルサーバーとクライアントPCに設定が反映されるようグループポリシーを更新します。

ドメインコントローラーで PowerShell (管理者として実行) を開く。
gpupdate /force コマンドを実行する。
ファイルサーバーおよびテスト用のクライアントPCでも gpupdate /force を実行する。

### ステップ4. 動作確認
1. 部長アカウントでクライアントPCにログオンし、各共有フォルダへのアクセス（読み取り、書き込み）を試す。
2. 課長アカウントでクライアントPCにログオンし、各共有フォルダへのアクセスを試す。
3. 役職なしアカウント（ProjectXメンバーに含む場合と含まない場合の両方）でクライアントPCにログオンし、各共有フォルダへのアクセスを試す。
4. 意図したアクセス許可/拒否が行われているかを確認する。