---
sidebar_position: 5
---

# 制御コマンド

バッチでは、制御コマンドを利用することでより複雑な処理を実行することができます  

## 変数

変数とは、名前のついた箱のようなもので **文字列や数値を格納** することができます  
変数に格納した文字列や数値のことを **変数の値** と呼びます  

```powershell title="変数「str1」に、文字列「これは文字列です」を格納する"
set str1="これは文字列です"
```

変数は `%変数名%` といったように `%(パーセント)`記号 で囲むことで  
**変数の値** を取り出すことができます  

```powershell title="変数の値をechoコマンドで表示"
set str1="これは文字列です"
echo %str1%
```

## for

複数のファイルやディレクトリに対して、コマンドを繰り返し実行するには `for`コマンド を利用します  

```powershell title="forコマンドの構文"
for {オプション} %%{変数名} in ({繰り返し対象}) do(
    {コマンド}
)
```

<details>
    <summary>使い方</summary>
    <div>

### 基本的な記法

例えば、カレントディレクトリに存在する「.txt」と付くファイルの名前を全て表示するには  
以下のように `for`コマンド を記述します  

- オプション: なし
- 変数名: 任意(今回は `f`)
- 繰り返し対象: `*.txt`

```powershell title="カレントディレクトリ配下の「.txt」ファイル名を表示します"
@echo off
for %%f in (*.txt) do (
    echo %%f
)
pause
```

:::tip
**繰り返し対象** にはファイルやディレクトリの名前を指定します  
指定をする際には `*`(ワイルドカード) を使用することができます  

ワイルドカードは、**なんだかの文字列や数値** を表す特殊な意味を持つ記号で  
`*.txt` の場合は、ファイル名の最後に **`.txt` という拡張子を持つファイルのみを指定する** という意味となります  
:::

<br />

### 繰り返す回数を指定

ファイルやディレクトリに対して繰り返しコマンドを実行する以外に  
指定した回数分のコマンドを繰り返すことも可能です  

以下の例では、  

    1. カウンタの値が 指定した `初期値` から `終了値` になるまでコマンドを繰り返す
    2. 1回繰り返すごとに カウンタの値を `カウントアップ` する

といった繰り返しが実行されます  

- オプション: /l(エル)
- 変数名: 任意(今回は `i`)
- 繰り返し対象: 1,1,5 (`{カウンタの初期値}`,`{1回繰り返すごとにカウントアップする数}`,`{カウンタの終了値}`)

```powershell title="echoコマンドを、カウンタが1から5にカウントアップするまで繰り返します"
@echo off
for /l %%i in (1,1,5) do (
    echo 繰り返し回数：%%i
)
pause
```

:::tip
**カウンタ** とは、繰り返しの回数を記録する変数です  
繰り返す回数を指定する`for`コマンド の場合、 `for`コマンドへ指定する変数(`%%{変数名}`)を **カウンタ** と呼びます  
:::
    </div>
</details>

## if

条件分岐と呼ばれ、指定した条件が **真(Ture)** であるか **否(False)** かで、それぞれ別のコマンドを実行することができます  

```powershell title="ifコマンドの構文"
if {条件} (
    {"真"の場合のコマンド}
) else (
    {"否"の場合のコマンド}
)
```


<details>
    <summary>使い方</summary>
    <div>

### 基本的な記法

以下のように記述することができます  

```powershell title="変数の値が [test] であるか否かで実行するコマンドを分けます"
@echo off
set a=test
set b=best

REM 変数aを判定
if %a%==test (
    echo aはtestです
) else (
    echo aはtestではありません
)

REM 変数bを判定
if %b%==test (
    echo bはtestです
) else (
    echo bはtestではありません
)
pause
```

:::tip
コマンドやバッチにおいて、 `REM` と記述された以降の文字列は **コメント** として扱われ  
実行する際にコマンドや処理と見なされず、自由にメモ等を記載することができます
:::

<br />

### else if
また、指定した条件が **真** でない場合(**否** である場合)に、別の条件を指定して  
**真** であるか **否** かを判定することもできます  

```powershell title="変数の値が [test] であるか否かで実行するコマンドを分けます"
@echo off
set a=rest
set b=test

REM 変数aを判定、"真"でなければ変数bを判定
if %a%==test (
    echo aはtestです
) else if %b%==test (
    echo aはtestではなく、bはtestです
) else (
    echo aとbはtestではありません
)
pause
```
    </div>
</details>