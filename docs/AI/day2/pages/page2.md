# 関数生成とエラー解消の自動化（脱・Excel職人）

本演習では、前章で学習した
「**プロンプト設計の考え方**」 を前提として、  
業務の依頼内容を整理し、生成AI（Copilot）が実行できる形に変換する方法を学習します。

![AI](../img/hikaku.jpg)


<details>
    <summary>導入</summary>
    <div>

まず、以下の動画をご視聴ください。<br />
https://drive.google.com/file/d/1AkqRVDfkb413jPJCovi3ge-XmQ5eWxo6/view?usp=sharing

動画の視聴が完了した方は、[Excel Copilot Pro の無料体験](https://www.microsoft.com/ja-jp/microsoft-365/try)を開始してください。

無料体験の開始後、<br />
[演習用ファイル](../files/day2演習課題用①.zip)から演習に必要なファイルをダウンロードしてください。<br />
ダウンロードが完了したら、演習課題を開始しましょう。
    </div>
</details>

<details>
    <summary>演習課題</summary>
    <div>

## 演習7-1　マスタ参照による列の自動補完

以降の演習では、上司の依頼内容を整理し、生成AI（Copilot）が実行できる形に翻訳したうえで、
その指示をもとにExcel操作を行ってください。

その際、考え方の整理に迷う場合は、以下の「業務翻訳シート」をご活用ください（使用は任意です）。

<details><summary>
業務翻訳シートはこちら
</summary>
## 業務翻訳シート(例)

### ① 元の業務依頼
例）  
受注リストに商品名を入れておいて

---

### ② 業務の目的
例）  
製品IDだけでなく、商品名も確認できる状態にしたい

---

### ③ 参照するデータ
例）  
- 参照するシート：商品マスタ  
- キーになる列：製品ID  

---

### ④ 実行したい処理
例）  
- 受注リストの製品IDを使って  
- 商品マスタから商品名を取得する  
- 受注リストに商品名を表示する  

---

### ⑤ 結果の出力先
例）  
- 出力先シート：受注リスト  
- 出力先列：商品名列  

---

### ⑥ 例外・注意点
例）  
- 商品マスタに存在しない製品IDがある可能性がある  
- まずはエラーが出ないことを優先したい  

---

### ⑦ Copilotに渡す指示文
例）  

受注リストと商品マスタの2つのシートがあります。  
受注リストには製品IDがあり、商品マスタには製品IDと商品名があります。

製品IDをキーにして、  
商品マスタから商品名を取得し、  
受注リストの各行に商品名を表示してください。


</details>


| 項目 | 内容 |
|---|---|
| ケース | あなたは営業部の事務担当です。「受注リスト」シートには **製品ID** と **数量** が入力されています。一方、「商品マスタ」シートには **製品ID・商品名・単価** が管理されています。上司から「受注リストに商品名と単価も入れておいて」と依頼されました。 |
| 演習内容 | 上司の依頼を、Copilotが実行できる形に翻訳し、**製品IDをキーにして商品名・単価を自動補完**してください。関数名（VLOOKUP / XLOOKUP 等）を暗記している前提にはせず、**「やりたい業務内容」からAIに作業手順や関数を提案させて実行**することを目的とします。 |
| 提出物 | ① Copilotに入力した指示文（上司の依頼をAI向けに翻訳した文章）<br />② 商品名・単価が補完されたExcelファイル |

---

## 演習7-2　マスタ参照＋例外処理

| 項目 | 内容 |
|---|---|
| ケース | 演習7-1と同様に「受注リスト」と「商品マスタ」がありますが、受注リストには **商品マスタに存在しない製品ID** が一部含まれています。上司から「商品名と単価を入れて、見つからないものは分かるようにしておいて」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、**商品名・単価を補完したうえで、マスタ未登録の行を識別できる状態**にしてください（例：商品名に「未登録」と表示、別列にフラグ列を追加 等）。 |
| 提出物 | ① Copilotに入力した指示文<br />② 未登録データが判別できる状態になったExcelファイル |

---

## 演習7-3　中間結果を使った参照先の切り替え

| 項目 | 内容 |
|---|---|
| ケース | 現在、手元には「受注リスト」「商品マスタ」「カテゴリマスタ」の3つのテーブルがあります。 上司から「**受注リストに、各注文の『商品名』と、標準単価に基づいた『合計金額』を表示させてほしい**」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後受注リストに新たな行が追加された場合でも、自動で「商品名」と「合計金額」が表示される仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 商品名・金額が算出されたExcelファイル |

---


# 演習7-4　参照＋並び替え＋上位抽出

| 項目 | 内容 |
|---|---|
| ケース | 受注リストには 製品ID・数量 が入力されています。商品マスタには 製品ID・商品名・単価 が管理されています。上司から「**金額（数量×単価）が高い順に並べて、上位5件の商品がすぐ分かるようにして**」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後受注データが追加・更新された場合でも、常に最新の「売上上位5件」が自動で判別・集約される仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 要件を満たしたExcelファイル |

---

# 演習7-5　複数条件をまたぐ例外処理

| 項目 | 内容 |
|---|---|
| ケース | 受注リストには 製品ID・数量 が入力されています。商品マスタには 製品ID・商品名・単価・販売区分（通常／廃番）があります。上司から「商品名と金額（数量×単価）を出して。ただし、廃番は除外して、数量が0のものも分かるようにして」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後データが追加された際、販売区分や数量の条件に応じた例外処理（除外や特定フラグの付与）が自動で適用される仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 要件を満たしたExcelファイル |

---


## 演習7-6　集計結果をもとにした行単位判定

| 項目 | 内容 |
|---|---|
| ケース | 受注リストには **製品ID・売上金額** が入力されています。上司から「**全体平均より売上が高い明細が分かるようにして**」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後データが追加された場合でも、その時点での全体平均と比較して「平均以上か」が自動で判定される仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 平均以上／未満が判別できるExcelファイル |

---

# 演習7-7　参照結果を使った条件付き集計

| 項目 | 内容 |
|---|---|
| ケース | 受注リストには 製品ID・数量・売上日 が入力されています。商品マスタには 製品ID・商品名・単価・販売区分（通常／廃番） が管理されています。上司から「廃番じゃない商品の売上金額だけを対象に、合計が分かるようにして」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後受注リストに行が追加された場合でも、販売区分に応じた最新の集計結果が常に反映される仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 要件を満たしたExcelファイル |

---

# 演習7-8　日付条件＋マスタ参照＋判定列の作成


| 項目 | 内容 |
|---|---|
| ケース |受注リストには 製品ID・数量・受注日 が入力されています。商品マスタには 製品ID・商品名・単価・伝票区分が管理されています。上司から「2025年10月分の受注だけを対象に金額を出してほしい。ただし、商品マスタで廃番・返品・サンプルとなっているものは除外して、高額なものが一目で分かるようにして」と依頼されました。 |
| 演習内容 | 上司の依頼をCopilot向けに翻訳し、今後データが追加された場合でも、特定の期間や伝票区分の条件に基づいた金額算出と、基準に応じた判定が自動で行われる仕組みを構築してください。 |
| 提出物 | ① Copilotに入力した指示文<br />② 要件を満たしたExcelファイル |

    </div>
</details>